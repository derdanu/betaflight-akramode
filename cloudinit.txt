#cloud-config
package_upgrade: true
packages:
  - build-essential
  - nginx
  - zip
write_files:
  - owner: www-data:www-data
    path: /etc/nginx/sites-available/default
    content: |
      server {
        listen 80;
        root /mnt/build/firmware;
        location / {
            autoindex on;
        }
      }
runcmd:
  - service nginx restart
  - mkdir -p /mnt/build
  - mkdir -p /mnt/build/firmware
  - cd /mnt/build
  - git clone https://github.com/derdanu/betaflight-akramode
  - git clone https://github.com/betaflight/betaflight.git
  - /bin/bash ./betaflight-akramode/build.sh
